var v=1.1,session_password=null;chrome.extension.onRequest.addListener(function(s,e,a){var o=JSON.parse(localStorage.passwords||"[]");if(console.log(s,e,a),e.tab||e.id)if("options"==s.message)a(JSON.parse(localStorage.options||"{}"));else if("init"==s.message||"request"==s.message)if(0==o.length&&"init"==s.message)a({length:0});else if(1==o.length||s.id&&s.id.length>0)id=1==parseInt(o.length)?o[0]:s.id,sendPass=Pass.init(id),s.password&&s.password.length>0&&sendPass.password(s.password),a(sendPass.generate(e.tab.url,s.disabletld));else if(o.length>1&&"init"==s.message){var t={};o.forEach(function(s){t[s]={id:s,name:localStorage["password_"+s+"_name"],hash:"hash"==localStorage["password_"+s+"_type"]&&localStorage["password_"+s+"_password"]}}),a({length:o.length,passes:t})}else 0==o.length&&"request"==s.message&&(sendPass=Pass.none,sendPass.password(s.password),a(sendPass.generate(e.tab.url,s.disabletld)));else"versioncheck"==s.message?(!localStorage.version||localStorage.version<v)&&(s.notify?localStorage.version=v.toFixed(1):a({notify:!0,message:"SuperChromePass has been updated to the latest version ("+v.toFixed(1).toString()+"). Click the options button for more:"})):(console.warn("Snubbing due to bad message:"),a({}))});